!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).naja=e()}(this,function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}var e=t(function(C){!function(t){var c,e=Object.prototype,s=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",r=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag",a=t.regeneratorRuntime;if(a)C.exports=a;else{(a=t.regeneratorRuntime=C.exports).wrap=b;var f="suspendedStart",h="suspendedYield",p="executing",d="completed",y={},u={};u[i]=function(){return this};var l=Object.getPrototypeOf,v=l&&l(l(_([])));v&&v!==e&&s.call(v,i)&&(u=v);var m=S.prototype=g.prototype=Object.create(u);E.prototype=m.constructor=S,S.constructor=E,S[o]=E.displayName="GeneratorFunction",a.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,o in t||(t[o]="GeneratorFunction")),t.prototype=Object.create(m),t},a.awrap=function(t){return{__await:t}},L(j.prototype),j.prototype[r]=function(){return this},a.AsyncIterator=j,a.async=function(t,e,n,r){var i=new j(b(t,e,n,r));return a.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},L(m),m[o]="Generator",m[i]=function(){return this},m.toString=function(){return"[object Generator]"},a.keys=function(n){var r=[];for(var t in n)r.push(t);return r.reverse(),function t(){for(;r.length;){var e=r.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=_,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=c)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function t(t,e){return o.type="throw",o.arg=n,r.next=t,e&&(r.method="next",r.arg=c),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var a=s.call(i,"catchLoc"),u=s.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&s.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;x(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=c),y}}}function b(t,e,n,r){var o,a,u,c,i=e&&e.prototype instanceof g?e:g,s=Object.create(i.prototype),l=new A(r||[]);return s._invoke=(o=t,a=n,u=l,c=f,function(t,e){if(c===p)throw new Error("Generator is already running");if(c===d){if("throw"===t)throw e;return T()}for(u.method=t,u.arg=e;;){var n=u.delegate;if(n){var r=k(n,u);if(r){if(r===y)continue;return r}}if("next"===u.method)u.sent=u._sent=u.arg;else if("throw"===u.method){if(c===f)throw c=d,u.arg;u.dispatchException(u.arg)}else"return"===u.method&&u.abrupt("return",u.arg);c=p;var i=w(o,a,u);if("normal"===i.type){if(c=u.done?d:h,i.arg===y)continue;return{value:i.arg,done:u.done}}"throw"===i.type&&(c=d,u.method="throw",u.arg=i.arg)}}),s}function w(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function g(){}function E(){}function S(){}function L(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function j(c){var e;this._invoke=function(n,r){function t(){return new Promise(function(t,e){!function e(t,n,r,i){var o=w(c[t],c,n);if("throw"!==o.type){var a=o.arg,u=a.value;return u&&"object"==typeof u&&s.call(u,"__await")?Promise.resolve(u.__await).then(function(t){e("next",t,r,i)},function(t){e("throw",t,r,i)}):Promise.resolve(u).then(function(t){a.value=t,r(a)},function(t){return e("throw",t,r,i)})}i(o.arg)}(n,r,t,e)})}return e=e?e.then(t,t):t()}}function k(t,e){var n=t.iterator[e.method];if(n===c){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=c,k(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var r=w(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,y;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=c),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function _(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(s.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=c,t.done=!0,t};return r.next=r}}return{next:T}}function T(){return{value:c,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())}),n=function(){return this||"object"==typeof self&&self}()||Function("return this")(),r=n.regeneratorRuntime&&0<=Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime"),i=r&&n.regeneratorRuntime;n.regeneratorRuntime=void 0;var o=e;if(r)n.regeneratorRuntime=i;else try{delete n.regeneratorRuntime}catch(t){n.regeneratorRuntime=void 0}var f=o;function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(t){s(e,t,n[t])})}return e}function l(t,e,n,r,i,o,a){try{var u=t[o](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,i)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t,e,n){return(p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&a(i,n.prototype),i}).apply(null,arguments)}function d(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t){return(b="function"==typeof Symbol&&"symbol"===c(Symbol.iterator)?function(t){return c(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":c(t)})(t)}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?w(t):e}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function L(t){var r="function"==typeof Map?new Map:void 0;return(L=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,n)}function n(){return p(t,arguments,E(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,t)})(t)}var j,k,O=t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),x=function(t){return"object"==typeof t?null!==t:"function"==typeof t},A=function(t){if(!x(t))throw TypeError(t+" is not an object!");return t},_=function(r,i,t){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(r),void 0===i)return r;switch(t){case 1:return function(t){return r.call(i,t)};case 2:return function(t,e){return r.call(i,t,e)};case 3:return function(t,e,n){return r.call(i,t,e,n)}}return function(){return r.apply(i,arguments)}},T={f:{}.propertyIsEnumerable},C=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},P={}.toString,R=function(t){return P.call(t).slice(8,-1)},M=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==R(t)?t.split(""):Object(t)},F=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},q=function(t){return M(F(t))},H=function(t,e){if(!x(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!x(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!x(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!x(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},N={}.hasOwnProperty,U=function(t,e){return N.call(t,e)},G=function(t){try{return!!t()}catch(t){return!0}},I=!G(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),z=O.document,D=x(z)&&x(z.createElement),K=function(t){return D?z.createElement(t):{}},V=!I&&!G(function(){return 7!=Object.defineProperty(K("div"),"a",{get:function(){return 7}}).a}),B=Object.getOwnPropertyDescriptor,W={f:I?B:function(t,e){if(t=q(t),e=H(e,!0),V)try{return B(t,e)}catch(t){}if(U(t,e))return C(!T.f.call(t,e),t[e])}},X=function(t,e){if(A(t),!x(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},Y={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,r){try{(r=_(Function.call,W.f(Object.prototype,"__proto__").set,2))(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,e){return X(t,e),n?t.__proto__=e:r(t,e),t}}({},!1):void 0),check:X}.set,J=Object.defineProperty,Q={f:I?Object.defineProperty:function(t,e,n){if(A(t),e=H(e,!0),A(n),V)try{return J(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},Z=Math.ceil,$=Math.floor,tt=function(t){return isNaN(t=+t)?0:(0<t?$:Z)(t)},et=Math.min,nt=Math.max,rt=Math.min,it="__core-js_shared__",ot=O[it]||(O[it]={}),at=function(t){return ot[t]||(ot[t]={})},ut=0,ct=Math.random(),st=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++ut+ct).toString(36))},lt=at("keys"),ft=function(t){return lt[t]||(lt[t]=st(t))},ht=(j=!1,function(t,e,n){var r,i,o,a,u=q(t),c=0<(r=u.length)?et(tt(r),9007199254740991):0,s=(o=c,(i=tt(i=n))<0?nt(i+o,0):rt(i,o));if(j&&e!=e){for(;s<c;)if((a=u[s++])!=a)return!0}else for(;s<c;s++)if((j||s in u)&&u[s]===e)return j||s||0;return!j&&-1}),pt=ft("IE_PROTO"),dt=function(t,e){var n,r=q(t),i=0,o=[];for(n in r)n!=pt&&U(r,n)&&o.push(n);for(;e.length>i;)U(r,n=e[i++])&&(~ht(o,n)||o.push(n));return o},yt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),vt=yt.concat("length","prototype"),mt={f:Object.getOwnPropertyNames||function(t){return dt(t,vt)}},bt=t(function(t){var e=at("wks"),n=O.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:st)("Symbol."+t))}).store=e}),wt=bt("match"),gt=I?function(t,e,n){return Q.f(t,e,C(1,n))}:function(t,e,n){return t[e]=n,t},Et=t(function(t){var e=t.exports={version:"2.5.1"};"number"==typeof __e&&(__e=e)}),St=(Et.version,t(function(t){var o=st("src"),e="toString",n=Function[e],a=(""+n).split(e);Et.inspectSource=function(t){return n.call(t)},(t.exports=function(t,e,n,r){var i="function"==typeof n;i&&(U(n,"name")||gt(n,"name",e)),t[e]!==n&&(i&&(U(n,o)||gt(n,o,t[e]?""+t[e]:a.join(String(e)))),t===O?t[e]=n:r?t[e]?t[e]=n:gt(t,e,n):(delete t[e],gt(t,e,n)))})(Function.prototype,e,function(){return"function"==typeof this&&this[o]||n.call(this)})})),Lt=bt("species"),jt=Q.f,kt=mt.f,Ot=O.RegExp,xt=Ot,At=Ot.prototype,_t=/a/g,Tt=/a/g,Ct=new Ot(_t)!==_t;if(I&&(!Ct||G(function(){return Tt[bt("match")]=!1,Ot(_t)!=_t||Ot(Tt)==Tt||"/a/i"!=Ot(_t,"i")}))){Ot=function(t,e){var n,r,i,o,a,u,c=this instanceof Ot,s=x(n=t)&&(void 0!==(r=n[wt])?!!r:"RegExp"==R(n)),l=void 0===e;return!c&&s&&t.constructor===Ot&&l?t:(i=Ct?new xt(s&&!l?t.source:t,e):xt((s=t instanceof Ot)?t.source:t,s&&l?function(){var t=A(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}.call(t):e),o=Ot,(u=(c?this:At).constructor)!==o&&"function"==typeof u&&(a=u.prototype)!==o.prototype&&x(a)&&Y&&Y(i,a),i)};for(var Pt=function(e){e in Ot||jt(Ot,e,{configurable:!0,get:function(){return xt[e]},set:function(t){xt[e]=t}})},Rt=kt(xt),Mt=0;Rt.length>Mt;)Pt(Rt[Mt++]);(At.constructor=Ot).prototype=At,St(O,"RegExp",Ot)}k=O["RegExp"],I&&k&&!k[Lt]&&Q.f(k,Lt,{configurable:!0,get:function(){return this}});var Ft,qt,Ht,Nt,Ut,Gt,It;qt=1,Ht=function(r,i,t){return[function(t){var e=r(this),n=null==t?void 0:t[i];return void 0!==n?n.call(t,e):new RegExp(t)[i](String(e))},t]},Nt=bt(Ft="search"),Ut=Ht(F,Nt,""[Ft]),Gt=Ut[0],It=Ut[1],G(function(){var t={};return t[Nt]=function(){return 7},7!=""[Ft](t)})&&(St(String.prototype,Ft,Gt),gt(RegExp.prototype,Nt,2==qt?function(t,e){return It.call(t,this,e)}:function(t){return It.call(t,this)}));var zt="matches"in Element.prototype?"matches":"msMatchesSelector",Dt=function(){function n(t){v(this,n),s(this,"selector",".ajax"),s(this,"allowedOrigins",[]),s(this,"handler",void 0),this.naja=t,this.handler=this.handleUI.bind(this),t.addEventListener("init",this.initialize.bind(this));var e="".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.port?":".concat(window.location.port):"");this.allowedOrigins.push(e)}return m(n,[{key:"initialize",value:function(){var n=this;this.bindUI(window.document.body),this.naja.snippetHandler.addEventListener("afterUpdate",function(t){var e=t.detail.snippet;n.bindUI(e)})}},{key:"bindUI",value:function(t){for(var e=this,n=["a".concat(this.selector),'input[type="submit"]'.concat(this.selector),'input[type="image"]'.concat(this.selector),'button[type="submit"]'.concat(this.selector),"form".concat(this.selector,' input[type="submit"]'),"form".concat(this.selector,' input[type="image"]'),"form".concat(this.selector,' button[type="submit"]')].join(", "),r=function(t){t.removeEventListener("click",e.handler),t.addEventListener("click",e.handler)},i=t.querySelectorAll(n),o=0;o<i.length;o++)r(i.item(o));t[zt](n)&&r(t);var a=function(t){t.removeEventListener("submit",e.handler),t.addEventListener("submit",e.handler)};t[zt]("form".concat(this.selector))&&a(t);for(var u=t.querySelectorAll("form".concat(this.selector)),c=0;c<u.length;c++)a(u.item(c))}},{key:"handleUI",value:function(t){if(!(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey||t.button)){var e=t.currentTarget,n={};"submit"===t.type?this.submitForm(e,n,t):"click"===t.type&&this.clickElement(e,n,t)}}},{key:"clickElement",value:function(t){var e,n,r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length?arguments[2]:void 0;if(this.naja.fireEvent("interaction",{element:t,originalEvent:o,options:i})){if("a"===t.tagName.toLowerCase())e="GET",n=t.href,r=null;else if("input"===t.tagName.toLowerCase()||"button"===t.tagName.toLowerCase()){var a=t.form;if(e=a.method?a.method.toUpperCase():"GET",n=a.action||window.location.pathname+window.location.search,r=new FormData(a),"submit"===t.type||"button"===t.tagName.toLowerCase())r.append(t.name,t.value||"");else if("image"===t.type){var u=t.getBoundingClientRect();r.append("".concat(t.name,".x"),Math.max(0,Math.floor(o.pageX-u.left))),r.append("".concat(t.name,".y"),Math.max(0,Math.floor(o.pageY-u.top)))}}this.isUrlAllowed(n)&&(o&&o.preventDefault(),this.naja.makeRequest(e,n,r,i))}else o&&o.preventDefault()}},{key:"submitForm",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;if(this.naja.fireEvent("interaction",{element:t,originalEvent:n,options:e})){var r=t.method?t.method.toUpperCase():"GET",i=t.action||window.location.pathname+window.location.search,o=new FormData(t);this.isUrlAllowed(i)&&(n&&n.preventDefault(),this.naja.makeRequest(r,i,o,e))}else n&&n.preventDefault()}},{key:"isUrlAllowed",value:function(e){return!/^(?!https?)[^:/?#]+:/i.test(e)&&(!/^https?/i.test(e)||this.allowedOrigins.some(function(t){return new RegExp("^".concat(t),"i").test(e)}))}}]),n}(),Kt=function(){function e(t){v(this,e),s(this,"netteForms",void 0),(this.naja=t).addEventListener("init",this.initialize.bind(this)),t.addEventListener("interaction",this.processForm.bind(this))}return m(e,[{key:"initialize",value:function(){var n=this;this.initForms(window.document.body),this.naja.snippetHandler.addEventListener("afterUpdate",function(t){var e=t.detail.snippet;n.initForms(e)})}},{key:"initForms",value:function(t){var e=this.netteForms||window.Nette;if(e){"form"===t.tagName&&e.initForm(t);for(var n=t.querySelectorAll("form"),r=0;r<n.length;r++)e.initForm(n.item(r))}}},{key:"processForm",value:function(t){var e=t.detail,n=e.element,r=e.originalEvent;n.form&&(n.form["nette-submittedBy"]=n);var i=this.netteForms||window.Nette;"form"!==n.tagName&&!n.form||!i||i.validateForm(n)||(r&&(r.stopImmediatePropagation(),r.preventDefault()),t.preventDefault())}}]),e}(),Vt=function(){function e(t){var i=this;v(this,e),(this.naja=t).addEventListener("success",function(t){var e=t.detail,n=e.payload,r=e.options;n.redirect&&(i.makeRedirect(n.redirect,n.forceRedirect||r.forceRedirect),t.stopImmediatePropagation())}),this.locationAdapter={assign:function(t){return window.location.assign(t)}}}return m(e,[{key:"makeRedirect",value:function(t,e){var n="".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.port?":".concat(window.location.port):""),r=/^https?/i.test(t)&&!new RegExp("^".concat(n),"i").test(t);e||r?this.locationAdapter.assign(t):this.naja.makeRequest("GET",t)}}]),e}(),Bt=bt("unscopables"),Wt=Array.prototype;null==Wt[Bt]&&gt(Wt,Bt,{});var Xt=function(t){Wt[Bt][t]=!0},Yt=function(t,e){return{value:e,done:!!t}},Jt={},Qt="prototype",Zt=function(t,e,n){var r,i,o,a,u=t&Zt.F,c=t&Zt.G,s=t&Zt.S,l=t&Zt.P,f=t&Zt.B,h=c?O:s?O[e]||(O[e]={}):(O[e]||{})[Qt],p=c?Et:Et[e]||(Et[e]={}),d=p[Qt]||(p[Qt]={});for(r in c&&(n=e),n)o=((i=!u&&h&&void 0!==h[r])?h:n)[r],a=f&&i?_(o,O):l&&"function"==typeof o?_(Function.call,o):o,h&&St(h,r,o,t&Zt.U),p[r]!=o&&gt(p,r,a),l&&d[r]!=o&&(d[r]=o)};O.core=Et,Zt.F=1,Zt.G=2,Zt.S=4,Zt.P=8,Zt.B=16,Zt.W=32,Zt.U=64,Zt.R=128;var $t=Zt,te=Object.keys||function(t){return dt(t,yt)},ee=I?Object.defineProperties:function(t,e){A(t);for(var n,r=te(e),i=r.length,o=0;o<i;)Q.f(t,n=r[o++],e[n]);return t},ne=O.document,re=ne&&ne.documentElement,ie=ft("IE_PROTO"),oe=function(){},ae="prototype",ue=function(){var t,e=K("iframe"),n=yt.length;for(e.style.display="none",re.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),ue=t.F;n--;)delete ue[ae][yt[n]];return ue()},ce=Object.create||function(t,e){var n;return null!==t?(oe[ae]=A(t),n=new oe,oe[ae]=null,n[ie]=t):n=ue(),void 0===e?n:ee(n,e)},se=Q.f,le=bt("toStringTag"),fe=function(t,e,n){t&&!U(t=n?t:t.prototype,le)&&se(t,le,{configurable:!0,value:e})},he={};gt(he,bt("iterator"),function(){return this});var pe=function(t){return Object(F(t))},de=ft("IE_PROTO"),ye=Object.prototype,ve=Object.getPrototypeOf||function(t){return t=pe(t),U(t,de)?t[de]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ye:null},me=bt("iterator"),be=!([].keys&&"next"in[].keys()),we="values",ge=function(){return this},Ee=function(t,e,n,r,i,o,a){var u,c,s;c=e,s=r,(u=n).prototype=ce(he,{next:C(1,s)}),fe(u,c+" Iterator");var l,f,h,p=function(t){if(!be&&t in m)return m[t];switch(t){case"keys":case we:return function(){return new n(this,t)}}return function(){return new n(this,t)}},d=e+" Iterator",y=i==we,v=!1,m=t.prototype,b=m[me]||m["@@iterator"]||i&&m[i],w=b||p(i),g=i?y?p("entries"):w:void 0,E="Array"==e&&m.entries||b;if(E&&(h=ve(E.call(new t)))!==Object.prototype&&h.next&&(fe(h,d,!0),U(h,me)||gt(h,me,ge)),y&&b&&b.name!==we&&(v=!0,w=function(){return b.call(this)}),(be||v||!m[me])&&gt(m,me,w),Jt[e]=w,Jt[d]=ge,i)if(l={values:y?w:p(we),keys:o?w:p("keys"),entries:g},a)for(f in l)f in m||St(m,f,l[f]);else $t($t.P+$t.F*(be||v),e,l);return l}(Array,"Array",function(t,e){this._t=q(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,Yt(1)):Yt(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");Jt.Arguments=Jt.Array,Xt("keys"),Xt("values"),Xt("entries");var Se,Le,je,ke;Se="keys",Le=function(){return function(t){return te(pe(t))}},je=(Et.Object||{})[Se]||Object[Se],(ke={})[Se]=Le(je),$t($t.S+$t.F*G(function(){je(1)}),"Object",ke);for(var Oe=bt("iterator"),xe=bt("toStringTag"),Ae=Jt.Array,_e={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Te=te(_e),Ce=0;Ce<Te.length;Ce++){var Pe,Re=Te[Ce],Me=_e[Re],Fe=O[Re],qe=Fe&&Fe.prototype;if(qe&&(qe[Oe]||gt(qe,Oe,Ae),qe[xe]||gt(qe,xe,Re),Jt[Re]=Ae,Me))for(Pe in Ee)qe[Pe]||St(qe,Pe,Ee[Pe],!0)}var He=function(t){function e(t){var n;return v(this,e),n=g(this,E(e).call(this)),t.addEventListener("success",function(t){var e=t.detail.payload;e.snippets&&n.updateSnippets(e.snippets)}),n}return S(e,L(EventTarget)),m(e,[{key:"updateSnippets",value:function(n){var r=this,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];Object.keys(n).forEach(function(t){var e=document.getElementById(t);e&&r.updateSnippet(e,n[t],i)})}},{key:"updateSnippet",value:function(t,e,n){this.dispatchEvent(new CustomEvent("beforeUpdate",{cancelable:!0,detail:{snippet:t,content:e}}))&&("title"===t.tagName.toLowerCase()?document.title=e:!t.hasAttribute("data-naja-snippet-prepend")&&!t.hasAttribute("data-ajax-prepend")||n?!t.hasAttribute("data-naja-snippet-append")&&!t.hasAttribute("data-ajax-append")||n?t.innerHTML=e:t.insertAdjacentHTML("beforeend",e):t.insertAdjacentHTML("afterbegin",e),this.dispatchEvent(new CustomEvent("afterUpdate",{cancelable:!0,detail:{snippet:t,content:e}})))}}]),e}(),Ne=function(){function e(t){v(this,e),s(this,"href",null),s(this,"uiCache",!0),(this.naja=t).addEventListener("init",this.initialize.bind(this)),t.addEventListener("interaction",this.configureMode.bind(this)),t.addEventListener("before",this.saveUrl.bind(this)),t.addEventListener("success",this.pushNewState.bind(this)),this.popStateHandler=this.handlePopState.bind(this),this.historyAdapter={replaceState:function(t,e,n){return window.history.replaceState(t,e,n)},pushState:function(t,e,n){return window.history.pushState(t,e,n)}}}return m(e,[{key:"initialize",value:function(){window.addEventListener("popstate",this.popStateHandler),this.historyAdapter.replaceState(this.buildState(window.location.href,this.uiCache),window.document.title,window.location.href)}},{key:"handlePopState",value:function(t){t.state&&(t.state.ui?(this.handleSnippets(t.state.ui),this.handleTitle(t.state.title)):!1===t.state.ui&&this.naja.makeRequest("GET",t.state.href,null,{history:!1,historyUiCache:!1}))}},{key:"saveUrl",value:function(t){var e=t.detail.url;this.href=e}},{key:"configureMode",value:function(t){var e=t.detail,n=e.element,r=e.options;n&&(n.hasAttribute("data-naja-history")&&(r.history=this.constructor.normalizeMode(n.getAttribute("data-naja-history"))),n.hasAttribute("data-naja-history-cache")&&(r.historyUiCache="off"!==n.getAttribute("data-naja-history-cache")))}},{key:"pushNewState",value:function(t){var e=t.detail,n=e.payload,r=e.options,i=this.constructor.normalizeMode(r.history);if(!1!==i){n.postGet&&n.url&&(this.href=n.url);var o=n.replaceHistory||"replace"===i?"replaceState":"pushState",a=!0===r.historyUiCache||!1!==r.historyUiCache&&this.uiCache;this.historyAdapter[o](this.buildState(this.href,a),window.document.title,this.href),this.href=null}}},{key:"buildState",value:function(t,e){var n={href:t};return n.ui=!!e&&(n.title=window.document.title,this.findSnippets()),n}},{key:"findSnippets",value:function(){for(var t={},e=window.document.querySelectorAll('[id^="snippet-"]'),n=0;n<e.length;n++){var r=e.item(n);r.hasAttribute("data-naja-history-nocache")||r.hasAttribute("data-history-nocache")||(t[r.id]=r.innerHTML)}return t}},{key:"handleSnippets",value:function(t){this.naja.snippetHandler.updateSnippets(t,!0),this.naja.scriptLoader.loadScripts(t),this.naja.load()}},{key:"handleTitle",value:function(t){window.document.title=t}}],[{key:"normalizeMode",value:function(t){return"off"!==t&&!1!==t&&("replace"!==t||"replace")}}]),e}(),Ue=function(){function e(t){var n=this;v(this,e),t.addEventListener("success",function(t){var e=t.detail.payload;e.snippets&&n.loadScripts(e.snippets)})}return m(e,[{key:"loadScripts",value:function(s){Object.keys(s).forEach(function(t){var e=s[t];if(/<script/i.test(e)){var n=window.document.createElement("div");n.innerHTML=e;for(var r=n.querySelectorAll("script"),i=0;i<r.length;i++){var o=r.item(i),a=window.document.createElement("script");if(a.innerHTML=o.innerHTML,o.hasAttributes())for(var u=o.attributes,c=0;c<u.length;c++){a[u[c].name]=u[c].value}window.document.head.appendChild(a).parentNode.removeChild(a)}}})}}]),e}(),Ge=function(t){function u(t,e,n,r,i,o){var a;return v(this,u),s(w(w(a=g(this,E(u).call(this)))),"initialized",!1),s(w(w(a)),"uiHandler",null),s(w(w(a)),"redirectHandler",null),s(w(w(a)),"snippetHandler",null),s(w(w(a)),"formsHandler",null),s(w(w(a)),"historyHandler",null),s(w(w(a)),"scriptLoader",null),s(w(w(a)),"extensions",[]),s(w(w(a)),"defaultOptions",{}),a.uiHandler=t?new t(w(w(a))):new Dt(w(w(a))),a.redirectHandler=e?new e(w(w(a))):new Vt(w(w(a))),a.snippetHandler=n?new n(w(w(a))):new He(w(w(a))),a.formsHandler=r?new r(w(w(a))):new Kt(w(w(a))),a.historyHandler=i?new i(w(w(a))):new Ne(w(w(a))),a.scriptLoader=o?new o(w(w(a))):new Ue(w(w(a))),a}var c,n;return S(u,L(EventTarget)),m(u,[{key:"registerExtension",value:function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.extensions.push([t,n])}},{key:"initialize",value:function(){var i=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(this.initialized)throw new Error("Cannot initialize Naja, it is already initialized.");this.defaultOptions=t,this.extensions=this.extensions.map(function(t){var e=y(t,2),n=e[0],r=e[1];return p(n,[i].concat(d(r)))}),this.fireEvent("init",{defaultOptions:t}),this.initialized=!0,this.load()}},{key:"load",value:function(){this.fireEvent("load")}},{key:"fireEvent",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=new CustomEvent(t,{cancelable:!0,detail:e});return this.dispatchEvent(n)}},{key:"makeRequest",value:(c=f.mark(function t(e,n){var r,i,o,a,u,c,s,l=arguments;return f.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=2<l.length&&void 0!==l[2]?l[2]:null,i=3<l.length&&void 0!==l[3]?l[3]:{},i=h({},this.defaultOptions,i,{fetch:h({},this.defaultOptions.fetch||{},i.fetch||{})}),o=new AbortController,(a=new Request(n,h({credentials:"same-origin"},i.fetch,{method:e,headers:new Headers(i.fetch.headers||{}),body:null!==r&&Object.getPrototypeOf(r)===Object.prototype?new URLSearchParams(r):r,signal:o.signal}))).headers.set("X-Requested-With","XMLHttpRequest"),this.fireEvent("before",{request:a,method:e,url:n,data:r,options:i})){t.next=8;break}return t.abrupt("return",{});case 8:return u=window.fetch(a),this.fireEvent("start",{request:a,promise:u,abortController:o,options:i}),t.prev=10,t.next=13,u;case 13:if((c=t.sent).ok){t.next=16;break}throw new Ie(c);case 16:return t.next=18,c.json();case 18:s=t.sent,t.next=31;break;case 21:if(t.prev=21,t.t0=t.catch(10),"AbortError"===t.t0.name)return this.fireEvent("abort",{request:a,error:t.t0,options:i}),this.fireEvent("complete",{request:a,response:c,payload:void 0,error:t.t0,options:i}),t.abrupt("return",{});t.next=27;break;case 27:throw this.fireEvent("error",{request:a,response:c,error:t.t0,options:i}),this.fireEvent("complete",{request:a,response:c,payload:void 0,error:t.t0,options:i}),this.load(),t.t0;case 31:return this.fireEvent("success",{request:a,response:c,payload:s,options:i}),this.fireEvent("complete",{request:a,response:c,payload:s,error:void 0,options:i}),this.load(),t.abrupt("return",s);case 35:case"end":return t.stop()}},t,this,[[10,21]])}),n=function(){var t=this,a=arguments;return new Promise(function(e,n){var r=c.apply(t,a);function i(t){l(r,e,n,i,o,"next",t)}function o(t){l(r,e,n,i,o,"throw",t)}i(void 0)})},function(t,e){return n.apply(this,arguments)})}]),u}(),Ie=function(t){function r(t){var e;v(this,r);var n="HTTP ".concat(t.status,": ").concat(t.statusText);return(e=g(this,E(r).call(this,n))).name=e.constructor.name,e.stack=new Error(n).stack,e.response=t,e}return S(r,L(Error)),r}(),ze=function(){function e(t){v(this,e),s(this,"abortable",!0),s(this,"abortController",null),t.addEventListener("init",this.initialize.bind(this)),t.addEventListener("interaction",this.checkAbortable.bind(this)),t.addEventListener("before",this.checkAbortable.bind(this)),t.addEventListener("start",this.saveAbortController.bind(this)),t.addEventListener("complete",this.clearAbortController.bind(this))}return m(e,[{key:"initialize",value:function(){var e=this;document.addEventListener("keydown",function(t){null!==e.abortController&&("key"in t?"Escape"===t.key:27===t.keyCode)&&!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)&&e.abortable&&(e.abortController.abort(),e.abortController=null)})}},{key:"checkAbortable",value:function(t){var e=t.detail,n=e.element,r=e.options;this.abortable=n?"off"!==n.getAttribute("data-naja-abort"):!1!==r.abort,r.abort=this.abortable}},{key:"saveAbortController",value:function(t){var e=t.detail.abortController;this.abortController=e}},{key:"clearAbortController",value:function(){this.abortController=null,this.abortable=!0}}]),e}(),De=function(){function e(t){v(this,e),s(this,"previousAbortController",null),t.addEventListener("interaction",this.checkUniqueness.bind(this)),t.addEventListener("start",this.abortPreviousRequest.bind(this)),t.addEventListener("complete",this.clearRequest.bind(this))}return m(e,[{key:"checkUniqueness",value:function(t){var e=t.detail,n=e.element;e.options.unique="off"!==n.getAttribute("data-naja-unique")}},{key:"abortPreviousRequest",value:function(t){var e=t.detail,n=e.abortController,r=e.options;null!==this.previousAbortController&&!1!==r.unique&&this.previousAbortController.abort(),this.previousAbortController=n}},{key:"clearRequest",value:function(){this.previousAbortController=null}}]),e}(),Ke=new Ge;return Ke.registerExtension(ze),Ke.registerExtension(De),Ke});
//# sourceMappingURL=Naja.min.js.map
